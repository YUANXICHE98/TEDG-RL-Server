# å¯è§†åŒ–å·¥å…·ä½¿ç”¨è¯´æ˜

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ç»¼åˆè®­ç»ƒå¯¹æ¯”å›¾

**æ–‡ä»¶**: `ablation_v3/visualizations/comprehensive_comparison/comprehensive_comparison.png`

**å†…å®¹**: 12ä¸ªå­å›¾å±•ç¤ºBaseline vs With Managerçš„å…¨é¢å¯¹æ¯”

**å…³é”®å‘ç°**:
- åˆ†æ•°æå‡: **+58.1%** (8.05 â†’ 12.73)
- å¥–åŠ±æå‡: **+186.0%** (6.17 â†’ 17.64)

**æŸ¥çœ‹**:
```bash
open ablation_v3/visualizations/comprehensive_comparison/comprehensive_comparison.png
```

---

## ğŸ“‹ å¾…å®Œæˆçš„å·¥ä½œ

### 2. ä¸“å®¶æ­£äº¤æ€§å¯è§†åŒ–

**ç›®çš„**: ç”Ÿæˆä¸¤å¼ å›¾è¯æ˜ä¸“å®¶çš„æ­£äº¤æ€§ï¼ˆç”¨äºè®ºæ–‡ï¼‰

#### å›¾1: Expert Activation Heatmap
- å±•ç¤ºæ—¶é—´ä¸Šçš„æ­£äº¤æ€§
- ä¸åŒæ—¶åˆ»æ¿€æ´»ä¸åŒä¸“å®¶
- å—çŠ¶åˆ†å¸ƒæ¨¡å¼

#### å›¾2: t-SNE Visualization
- å±•ç¤ºå‚æ•°ç©ºé—´çš„æ­£äº¤æ€§
- 4ä¸ªä¸“å®¶å½¢æˆåˆ†ç¦»çš„cluster
- è¯æ˜ä¸“å®¶å­¦ä¹ åˆ°ä¸åŒè¡¨ç¤º

---

## ğŸš€ å¦‚ä½•ç”Ÿæˆä¸“å®¶æ­£äº¤æ€§å›¾

### å‰ææ¡ä»¶

éœ€è¦åœ¨**æœ‰PyTorchçš„ç¯å¢ƒ**ä¸­è¿è¡Œï¼ˆè®­ç»ƒæœåŠ¡å™¨æˆ–æœ¬åœ°å®‰è£…ä¾èµ–ï¼‰

### æ­¥éª¤1: æå–æ•°æ®

```bash
python3 tools/extract_real_expert_data.py
```

**è¿™ä¸ªè„šæœ¬åšä»€ä¹ˆ**:
1. åŠ è½½è®­ç»ƒå¥½çš„checkpoint
2. è¿è¡Œ5ä¸ªinference episodes
3. è®°å½•æ¯ä¸ªstepçš„alphaå€¼ï¼ˆä¸“å®¶æ¿€æ´»ï¼‰
4. æå–ä¸“å®¶ç½‘ç»œæƒé‡

**è¾“å‡º**:
- `ablation_v3/visualizations/expert_data/alpha_history.npy`
- `ablation_v3/visualizations/expert_data/expert_weights.npy`
- `ablation_v3/visualizations/expert_data/episodes_analysis.json`

### æ­¥éª¤2: ç”Ÿæˆå¯è§†åŒ–

```bash
python3 tools/visualize_expert_orthogonality_real.py
```

**è¾“å‡º**:
- `expert_activation_heatmap_real.png` - çƒ­åŠ›å›¾
- `expert_weights_tsne_real.png` - t-SNEå›¾
- `expert_orthogonality_combined_real.png` - **ç»„åˆå›¾ï¼ˆç”¨äºè®ºæ–‡ï¼‰**

---

## ğŸ’¡ å¦‚æœæ²¡æœ‰PyTorchç¯å¢ƒ

### æ–¹æ¡ˆ1: åœ¨è®­ç»ƒæœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆæ¨èï¼‰

```bash
# 1. SSHåˆ°è®­ç»ƒæœåŠ¡å™¨
ssh your-training-server

# 2. æ¿€æ´»è®­ç»ƒç¯å¢ƒ
conda activate your-rl-env

# 3. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/TEDG-RL-Server

# 4. è¿è¡Œè„šæœ¬
python3 tools/extract_real_expert_data.py
python3 tools/visualize_expert_orthogonality_real.py

# 5. åœ¨æœ¬åœ°ä¸‹è½½å›¾ç‰‡
# åœ¨æœ¬åœ°ç»ˆç«¯è¿è¡Œï¼š
scp your-server:/path/to/ablation_v3/visualizations/expert_orthogonality/*.png ./
```

### æ–¹æ¡ˆ2: æœ¬åœ°å®‰è£…ä¾èµ–

```bash
pip install torch numpy matplotlib seaborn scikit-learn nle
```

ç„¶åè¿è¡Œä¸Šé¢çš„æ­¥éª¤1å’Œæ­¥éª¤2ã€‚

---

## ğŸ“Š é¢„æœŸç»“æœ

### Expert Activation Heatmap

**å¥½çš„ç»“æœ**:
```
æ¨ªè½´: æ—¶é—´æ­¥ (0-1000)
çºµè½´: ä¸“å®¶ (0-3)
é¢œè‰²: æ¿€æ´»å¼ºåº¦ (çº¢è‰²=é«˜)

åº”è¯¥çœ‹åˆ°ï¼š
Expert 0: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  <- å‰æœŸä¸»å¯¼ï¼ˆæˆ˜æ–—ï¼‰
Expert 1: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  <- ä¸­æœŸä¸»å¯¼ï¼ˆæ¢ç´¢ï¼‰
Expert 2: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  <- åæœŸä¸»å¯¼ï¼ˆç‰©å“ï¼‰
Expert 3: â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  <- å¶å°”æ¿€æ´»ï¼ˆæ²»ç–—ï¼‰
```

**è¯æ˜**: ä¸åŒä¸“å®¶åœ¨ä¸åŒæ—¶åˆ»è¢«æ¿€æ´» = **æ—¶é—´æ­£äº¤æ€§**

### t-SNE Visualization

**å¥½çš„ç»“æœ**:
```
2Dæ•£ç‚¹å›¾ï¼Œ4ä¸ªæ¸…æ™°åˆ†ç¦»çš„cluster

å…³é”®æŒ‡æ ‡ï¼š
- Separation Ratio > 2.0 = å¼ºæ­£äº¤æ€§ âœ…
- Separation Ratio > 1.0 = ä¸­ç­‰æ­£äº¤æ€§ âš ï¸
- Separation Ratio < 1.0 = å¼±æ­£äº¤æ€§ âŒ
```

**è¯æ˜**: ä¸“å®¶æƒé‡åœ¨å‚æ•°ç©ºé—´ä¸­åˆ†ç¦» = **å‚æ•°ç©ºé—´æ­£äº¤æ€§**

---

## ğŸ“ è®ºæ–‡ä¸­å¦‚ä½•ä½¿ç”¨

### Figure Caption

```
Figure X: Expert Orthogonality Analysis. 
(a) Expert Activation Heatmap demonstrates temporal orthogonality: 
different experts are activated at different time steps, showing 
specialized behavior for different game scenarios. 
(b) t-SNE visualization of expert weights demonstrates parameter 
space orthogonality: the four experts form well-separated clusters 
(separation ratio = X.XX), indicating distinct learned representations.
```

### æ­£æ–‡æè¿°

```
æˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªåˆ†æéªŒè¯ä¸“å®¶ç½‘ç»œçš„æ­£äº¤æ€§ï¼š

1. æ—¶é—´æ­£äº¤æ€§ï¼šå›¾X(a)æ˜¾ç¤ºäº†ä¸“å®¶æ¿€æ´»çƒ­åŠ›å›¾ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°æ¸…æ™°çš„
   å—çŠ¶åˆ†å¸ƒï¼Œä¸åŒä¸“å®¶åœ¨ä¸åŒæ—¶åˆ»ä¸»å¯¼ï¼Œè¯æ˜äº†ä¸“å®¶çš„æ—¶é—´ä¸“ä¸šåŒ–ã€‚

2. å‚æ•°ç©ºé—´æ­£äº¤æ€§ï¼šå›¾X(b)æ˜¾ç¤ºäº†ä¸“å®¶æƒé‡çš„t-SNEå¯è§†åŒ–ã€‚å››ä¸ª
   ä¸“å®¶å½¢æˆäº†æ¸…æ™°åˆ†ç¦»çš„clusterï¼ˆåˆ†ç¦»æ¯”ç‡=X.XXï¼‰ï¼Œç¡®è®¤äº†æ¯ä¸ª
   ä¸“å®¶å­¦ä¹ åˆ°äº†ä¸åŒçš„è¡¨ç¤ºã€‚
```

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### å·¥å…·è„šæœ¬
- âœ… `tools/visualize_comprehensive_comparison.py` - ç»¼åˆå¯¹æ¯”ï¼ˆå·²è¿è¡Œï¼‰
- ğŸ“‹ `tools/extract_real_expert_data.py` - æå–ä¸“å®¶æ•°æ®ï¼ˆå¾…è¿è¡Œï¼‰
- ğŸ“‹ `tools/visualize_expert_orthogonality_real.py` - ä¸“å®¶å¯è§†åŒ–ï¼ˆå¾…è¿è¡Œï¼‰

### ç”Ÿæˆçš„å›¾è¡¨
- âœ… `ablation_v3/visualizations/comprehensive_comparison/comprehensive_comparison.png`
- ğŸ“‹ `ablation_v3/visualizations/expert_orthogonality/expert_orthogonality_combined_real.png`

### è¯´æ˜æ–‡æ¡£
- `ablation_v3/EXPERT_ORTHOGONALITY_VISUALIZATION_GUIDE.md` - è¯¦ç»†æŒ‡å—ï¼ˆè‹±æ–‡ï¼‰
- `ablation_v3/ä¸“å®¶æ­£äº¤æ€§å¯è§†åŒ–è¯´æ˜.md` - å¿«é€ŸæŒ‡å—ï¼ˆä¸­æ–‡ï¼‰
- `ablation_v3/VISUALIZATION_TOOLS_SUMMARY.md` - å·¥å…·æ€»ç»“ï¼ˆè‹±æ–‡ï¼‰
- `ablation_v3/å¯è§†åŒ–å·¥å…·ä½¿ç”¨è¯´æ˜.md` - æœ¬æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰

---

## âœ… æ£€æŸ¥æ¸…å•

**ç»¼åˆå¯¹æ¯”å›¾**:
- [x] å·¥å…·å·²åˆ›å»º
- [x] å·²è¿è¡Œå¹¶ç”Ÿæˆå›¾è¡¨
- [x] å¯ä»¥ç›´æ¥ç”¨äºè®ºæ–‡

**ä¸“å®¶æ­£äº¤æ€§å›¾**:
- [x] å·¥å…·å·²åˆ›å»º
- [ ] åœ¨PyTorchç¯å¢ƒä¸­è¿è¡Œæ•°æ®æå–
- [ ] è¿è¡Œå¯è§†åŒ–ç”Ÿæˆ
- [ ] æ£€æŸ¥å›¾è¡¨è´¨é‡
- [ ] æ·»åŠ åˆ°è®ºæ–‡

---

## ğŸ”§ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆéœ€è¦PyTorchç¯å¢ƒï¼Ÿ**

A: å› ä¸ºéœ€è¦ï¼š
1. åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹checkpoint
2. è¿è¡Œinference episodes
3. è®°å½•ä¸“å®¶æ¿€æ´»æ•°æ®

**Q: å¯ä»¥ç”¨åˆæˆæ•°æ®å—ï¼Ÿ**

A: ä¸å»ºè®®ã€‚è®ºæ–‡éœ€è¦çœŸå®è®­ç»ƒæ•°æ®æ¥è¯æ˜ä¸“å®¶ç¡®å®å­¦ä¹ åˆ°äº†æ­£äº¤çš„è¡¨ç¤ºã€‚

**Q: éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ**

A: 
- æ•°æ®æå–ï¼šçº¦5-10åˆ†é’Ÿï¼ˆè¿è¡Œ5ä¸ªepisodesï¼‰
- å¯è§†åŒ–ç”Ÿæˆï¼šçº¦1-2åˆ†é’Ÿ

**Q: å¦‚æœcheckpointä¸å­˜åœ¨ï¼Ÿ**

A: æ£€æŸ¥å¯ç”¨çš„checkpointsï¼š
```bash
ls ablation_v3/results/resume_500_from_100/checkpoints/
```
ç„¶åä¿®æ”¹è„šæœ¬ä¸­çš„è·¯å¾„ã€‚

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š
- è‹±æ–‡ï¼š`ablation_v3/EXPERT_ORTHOGONALITY_VISUALIZATION_GUIDE.md`
- ä¸­æ–‡ï¼š`ablation_v3/ä¸“å®¶æ­£äº¤æ€§å¯è§†åŒ–è¯´æ˜.md`

---

**åˆ›å»ºæ—¶é—´**: 2026-01-13  
**å½“å‰çŠ¶æ€**: 
- âœ… ç»¼åˆå¯¹æ¯”å›¾å·²å®Œæˆ
- ğŸ“‹ ä¸“å®¶æ­£äº¤æ€§å›¾å·¥å…·å·²åˆ›å»ºï¼Œç­‰å¾…è¿è¡Œ

**ä¸‹ä¸€æ­¥**: åœ¨PyTorchç¯å¢ƒä¸­è¿è¡Œä¸“å®¶æ­£äº¤æ€§å¯è§†åŒ–å·¥å…·
