# V3è®­ç»ƒæ”¹è¿›æ–¹æ¡ˆ

**æ—¥æœŸ**: 2026-01-10  
**å½“å‰çŠ¶æ€**: Fine-tuneé˜¶æ®µå®Œæˆï¼Œæ•ˆæœéƒ¨åˆ†è¾¾æ ‡  
**ç›®æ ‡**: æå‡ä¸“å®¶ä¸“ä¸šåŒ–ç¨‹åº¦å’Œæ¨¡å‹æ€§èƒ½

---

## å½“å‰é—®é¢˜æ€»ç»“

### ğŸ“Š ä¸‰é˜¶æ®µè®­ç»ƒç»“æœ

| é˜¶æ®µ | Episodes | å¹³å‡åˆ†æ•° | Alphaç†µ | çŠ¶æ€ |
|------|----------|----------|---------|------|
| Warmup | 0-1000 | 8.50 | 1.3842 | âœ… å®Œæˆ |
| Transition | 1000-3000 | 9.56 (+12.5%) | 0.6938 (-50%) | âœ… å®Œæˆ |
| Fine-tune | 3000-5000 | 12.23 (+28.0%) | 0.6928 (-0.1%) | âš ï¸  éƒ¨åˆ†è¾¾æ ‡ |

### ğŸ¯ æ ¸å¿ƒé—®é¢˜

#### é—®é¢˜1: Alphaç†µåœæ»ï¼ˆæœ€ä¸¥é‡ï¼‰

**ç°è±¡**: Alphaç†µä»0.6938é™åˆ°0.6928ï¼Œå‡ ä¹æ²¡æœ‰å˜åŒ–

**åŸå› **:
1. **æ¸©åº¦å›ºå®š**: Fine-tuneé˜¶æ®µæ¸©åº¦å›ºå®šåœ¨0.5ï¼Œæ²¡æœ‰ç»§ç»­é€€ç«
2. **å­¦ä¹ ç‡å¤ªä½**: 1e-5å¤ªä½ï¼Œæ¨¡å‹å‚æ•°æ›´æ–°ç¼“æ…¢
3. **å±€éƒ¨æœ€ä¼˜**: ä¸“å®¶åˆ†å·¥æ¨¡å¼é™·å…¥å±€éƒ¨æœ€ä¼˜

**å½±å“**:
- ä¸“å®¶åªè¾¾åˆ°"ä¸­åº¦ä¸“ä¸šåŒ–"ï¼ˆAlphaç†µ0.69ï¼‰
- ç›®æ ‡æ˜¯"é«˜åº¦ä¸“ä¸šåŒ–"ï¼ˆAlphaç†µ0.3-0.5ï¼‰
- ä¸“å®¶åˆ†å·¥ä¸å¤Ÿæ˜ç¡®ï¼Œæ•ˆç‡ä¸é«˜

---

#### é—®é¢˜2: æ–¹å·®ä¸Šå‡

**ç°è±¡**: æ–¹å·®ä»16.53ä¸Šå‡åˆ°22.39 (+35.5%)

**åŸå› **:
1. **æç«¯é«˜åˆ†**: æœ€é«˜åˆ†489æ‹‰é«˜æ–¹å·®
2. **ä¸“å®¶åˆ†å·¥å›ºåŒ–**: æ“…é•¿çš„åœºæ™¯å¾ˆå¥½ï¼Œä¸æ“…é•¿çš„åœºæ™¯ä¸€èˆ¬
3. **è¡¨ç°ä¸¤æåŒ–**: é«˜åˆ†å¢å¤šï¼ˆ>50åˆ†ä»3.5%æå‡åˆ°4.7%ï¼‰

**å½±å“**:
- è¡¨ç°ä¸ç¨³å®š
- ä½†è¿™å¯èƒ½ä¸æ˜¯åäº‹ï¼ˆè¯´æ˜æ¨¡å‹åœ¨æŸäº›åœºæ™¯ä¸‹å·²ç»å¾ˆå¼ºï¼‰

---

#### é—®é¢˜3: å¹³å‡åˆ†æ•°ä½äºé¢„æœŸ

**ç°è±¡**: å¹³å‡åˆ†æ•°12.23ï¼Œä½äºé¢„æœŸ15-20

**åŸå› **:
1. **ä¸“å®¶ä¸“ä¸šåŒ–ä¸å¤Ÿ**: Alphaç†µ0.69è¿˜æ˜¯åé«˜
2. **è®­ç»ƒæ—¶é—´ä¸å¤Ÿ**: æœ€å500è½®åˆ†æ•°è¿˜åœ¨æå‡ï¼ˆ14.43ï¼‰
3. **NetHackæœ¬èº«å¾ˆéš¾**: å¤§éƒ¨åˆ†episodeè¿˜æ˜¯å¾ˆéš¾

**å½±å“**:
- æ€§èƒ½æå‡æœ‰é™
- ä½†è¶‹åŠ¿æ˜¯æ­£ç¡®çš„ï¼ˆ+43.9% vs Warmupï¼‰

---

## æ·±åº¦åˆ†æ

### ğŸ” Alphaç†µåœæ»çš„æ·±å±‚åŸå› 

#### æ¸©åº¦é€€ç«æ•ˆæœå¯¹æ¯”

```
Transitioné˜¶æ®µï¼ˆæ¸©åº¦é€€ç«ï¼‰:
  Episode 1000: æ¸©åº¦1.0, Alphaç†µ1.38
  Episode 1500: æ¸©åº¦0.875, Alphaç†µ0.697
  Episode 2000: æ¸©åº¦0.75, Alphaç†µ0.693
  Episode 2500: æ¸©åº¦0.625, Alphaç†µ0.693
  Episode 3000: æ¸©åº¦0.5, Alphaç†µ0.693
  
  ç»“æœ: Alphaç†µå¿«é€Ÿä¸‹é™50%

Fine-tuneé˜¶æ®µï¼ˆæ¸©åº¦å›ºå®šï¼‰:
  Episode 3000-5000: æ¸©åº¦0.5, Alphaç†µ0.693
  
  ç»“æœ: Alphaç†µå‡ ä¹ä¸å˜
```

**ç»“è®º**: æ¸©åº¦é€€ç«æ˜¯ä¸“å®¶ä¸“ä¸šåŒ–çš„å…³é”®ï¼

---

#### ä¸“å®¶åˆ†å·¥æ¨¡å¼åˆ†æ

**å½“å‰çŠ¶æ€ï¼ˆAlphaç†µ0.69ï¼‰**:

```
åœºæ™¯A: [0.6, 0.3, 0.1, 0.0]  # 1ä¸ªä¸»å¯¼ + 1ä¸ªè¾…åŠ©
åœºæ™¯B: [0.1, 0.7, 0.2, 0.0]  # 1ä¸ªä¸»å¯¼ + 1ä¸ªè¾…åŠ©
åœºæ™¯C: [0.0, 0.1, 0.8, 0.1]  # 1ä¸ªä¸»å¯¼ + 1ä¸ªè¾…åŠ©
åœºæ™¯D: [0.2, 0.2, 0.2, 0.4]  # 1ä¸ªä¸»å¯¼ + 3ä¸ªè¾…åŠ©
```

è¿™æ˜¯"ä¸­åº¦ä¸“ä¸šåŒ–"ï¼š
- âœ… æœ‰ä¸»å¯¼ä¸“å®¶
- âš ï¸  ä½†å…¶ä»–ä¸“å®¶ä¹Ÿå‚ä¸è¾ƒå¤š
- âš ï¸  åˆ†å·¥ä¸å¤Ÿæ˜ç¡®

**ç›®æ ‡çŠ¶æ€ï¼ˆAlphaç†µ0.3-0.5ï¼‰**:

```
åœºæ™¯A: [0.9, 0.1, 0.0, 0.0]  # 1ä¸ªä¸“å®¶å®Œå…¨ä¸»å¯¼
åœºæ™¯B: [0.0, 0.9, 0.1, 0.0]  # 1ä¸ªä¸“å®¶å®Œå…¨ä¸»å¯¼
åœºæ™¯C: [0.0, 0.0, 1.0, 0.0]  # 1ä¸ªä¸“å®¶å®Œå…¨ä¸»å¯¼
åœºæ™¯D: [0.1, 0.0, 0.0, 0.9]  # 1ä¸ªä¸“å®¶å®Œå…¨ä¸»å¯¼
```

è¿™æ˜¯"é«˜åº¦ä¸“ä¸šåŒ–"ï¼š
- âœ… æ¯ä¸ªåœºæ™¯ç”±1ä¸ªä¸“å®¶å®Œå…¨ä¸»å¯¼
- âœ… å…¶ä»–ä¸“å®¶å‡ ä¹ä¸å‚ä¸
- âœ… åˆ†å·¥éå¸¸æ˜ç¡®

---

### ğŸ” åˆ†æ•°åˆ†å¸ƒåˆ†æ

#### ä¸‰é˜¶æ®µåˆ†æ•°åˆ†å¸ƒå¯¹æ¯”

| åˆ†æ•°åŒºé—´ | Warmup | Transition | Fine-tune | å˜åŒ– |
|---------|--------|------------|-----------|------|
| 0-5åˆ† | 61.6% | 58.7% | 50.8% | âœ… ä¸‹é™ |
| 5-10åˆ† | 14.6% | 14.0% | 15.8% | âš ï¸  æŒå¹³ |
| 10-20åˆ† | 7.3% | 9.4% | 11.8% | âœ… ä¸Šå‡ |
| 20-50åˆ† | 13.6% | 14.0% | 16.1% | âœ… ä¸Šå‡ |
| 50-100åˆ† | 2.6% | 3.4% | 4.7% | âœ… ä¸Šå‡ |
| 100+åˆ† | 0.3% | 0.5% | 0.9% | âœ… ä¸Šå‡ |

**å…³é”®å‘ç°**:
1. âœ… ä½åˆ†ï¼ˆ0-5ï¼‰æ¯”ä¾‹ä¸‹é™ï¼ˆ61.6% â†’ 50.8%ï¼‰
2. âœ… é«˜åˆ†ï¼ˆ>50ï¼‰æ¯”ä¾‹ä¸Šå‡ï¼ˆ2.9% â†’ 5.6%ï¼‰
3. âœ… è¶…é«˜åˆ†ï¼ˆ100+ï¼‰æ¯”ä¾‹ä¸Šå‡ï¼ˆ0.3% â†’ 0.9%ï¼‰

**ç»“è®º**: æ¨¡å‹åœ¨è¿›æ­¥ï¼Œåªæ˜¯è¿›æ­¥ä¸å‡åŒ€ï¼

---

## æ”¹è¿›æ–¹æ¡ˆ

### ğŸš€ æ–¹æ¡ˆ1: ç»§ç»­æ¸©åº¦é€€ç«ï¼ˆå¼ºçƒˆæ¨èï¼‰

#### ç›®æ ‡
- Alphaç†µ: 0.69 â†’ 0.3-0.5
- å¹³å‡åˆ†æ•°: 12.23 â†’ 15-20+
- ä¸“å®¶å®Œå…¨ä¸“ä¸šåŒ–

#### ç­–ç•¥

**Phase 4: Deep Fine-tune (5000-7000 episodes)**

```python
{
    'phase': 'deep_finetune',
    'use_sparsemax': True,
    'sparsemax_temp': 0.5 â†’ 0.2,  # ç»§ç»­é€€ç«
    'learning_rate': 5e-5,  # æé«˜å­¦ä¹ ç‡
    'entropy_coef': 0.005,  # é™ä½ç†µç³»æ•°
    'alpha_entropy_coef': 0.1,  # æé«˜Alphaç†µæƒ©ç½š
    'load_balance_coef': 0.005,
    'diversity_coef': 0.005,
}
```

**æ¸©åº¦é€€ç«ç­–ç•¥**:
```python
# Episode 5000-7000: æ¸©åº¦ä»0.5é€€ç«åˆ°0.2
progress = (episode - 5000) / 2000  # 0 â†’ 1
temperature = 0.5 - 0.3 * progress  # 0.5 â†’ 0.2
```

**é¢„æœŸæ•ˆæœ**:
- Alphaç†µç»§ç»­ä¸‹é™åˆ°0.3-0.5
- ä¸“å®¶å®Œå…¨ä¸“ä¸šåŒ–
- å¹³å‡åˆ†æ•°æå‡åˆ°15-20+

**å‘½ä»¤**:
```bash
python ablation_v3/train/train_v3_gat_moe.py \
    --exp-name deep_finetune_7000 \
    --episodes 7000 \
    --max-steps 500 \
    --resume ablation_v3/results/finetune_5000/checkpoints/model_final.pth \
    --sparsemax-temp-start 0.5 \
    --sparsemax-temp-end 0.2 \
    --learning-rate 5e-5
```

---

### ğŸš€ æ–¹æ¡ˆ2: æ¿€è¿›æ¸©åº¦é€€ç«ï¼ˆå®éªŒæ€§ï¼‰

#### ç›®æ ‡
- å¿«é€Ÿè¾¾åˆ°é«˜åº¦ä¸“ä¸šåŒ–
- Alphaç†µ: 0.69 â†’ 0.2-0.3

#### ç­–ç•¥

**Phase 4: Aggressive Fine-tune (5000-6000 episodes)**

```python
{
    'phase': 'aggressive_finetune',
    'use_sparsemax': True,
    'sparsemax_temp': 0.5 â†’ 0.1,  # æ¿€è¿›é€€ç«
    'learning_rate': 1e-4,  # æ›´é«˜å­¦ä¹ ç‡
    'entropy_coef': 0.001,  # æä½ç†µç³»æ•°
    'alpha_entropy_coef': 0.2,  # æé«˜Alphaç†µæƒ©ç½š
    'load_balance_coef': 0.001,
    'diversity_coef': 0.001,
}
```

**æ¸©åº¦é€€ç«ç­–ç•¥**:
```python
# Episode 5000-6000: æ¸©åº¦ä»0.5å¿«é€Ÿé€€ç«åˆ°0.1
progress = (episode - 5000) / 1000  # 0 â†’ 1
temperature = 0.5 - 0.4 * progress  # 0.5 â†’ 0.1
```

**é£é™©**:
- âš ï¸  å¯èƒ½å¯¼è‡´è®­ç»ƒä¸ç¨³å®š
- âš ï¸  å¯èƒ½å¯¼è‡´æŸäº›ä¸“å®¶å®Œå…¨ä¸è¢«ä½¿ç”¨
- âš ï¸  éœ€è¦å¯†åˆ‡ç›‘æ§

**é¢„æœŸæ•ˆæœ**:
- Alphaç†µå¿«é€Ÿä¸‹é™åˆ°0.2-0.3
- ä¸“å®¶æåº¦ä¸“ä¸šåŒ–
- æ€§èƒ½å¯èƒ½å¤§å¹…æå‡æˆ–ä¸‹é™ï¼ˆéœ€è¦å®éªŒï¼‰

---

### ğŸš€ æ–¹æ¡ˆ3: å»¶é•¿è®­ç»ƒï¼ˆä¿å®ˆï¼‰

#### ç›®æ ‡
- åœ¨å½“å‰æ¸©åº¦ä¸‹ç»§ç»­è®­ç»ƒ
- è®©æ¨¡å‹å……åˆ†å­¦ä¹ 

#### ç­–ç•¥

**Phase 4: Extended Fine-tune (5000-8000 episodes)**

```python
{
    'phase': 'extended_finetune',
    'use_sparsemax': True,
    'sparsemax_temp': 0.5,  # ä¿æŒæ¸©åº¦
    'learning_rate': 1e-5,  # ä¿æŒå­¦ä¹ ç‡
    # å…¶ä»–å‚æ•°ä¸å˜
}
```

**é¢„æœŸæ•ˆæœ**:
- Alphaç†µå¯èƒ½ç•¥å¾®ä¸‹é™ï¼ˆ0.69 â†’ 0.65ï¼‰
- å¹³å‡åˆ†æ•°ç¼“æ…¢æå‡ï¼ˆ12.23 â†’ 14-16ï¼‰
- æœ€ç¨³å®šï¼Œä½†æå‡æœ‰é™

---

## æ¨èæ–¹æ¡ˆ

### ğŸ¯ æ¨èï¼šæ–¹æ¡ˆ1ï¼ˆç»§ç»­æ¸©åº¦é€€ç«ï¼‰

**ç†ç”±**:
1. âœ… Transitioné˜¶æ®µè¯æ˜æ¸©åº¦é€€ç«éå¸¸æœ‰æ•ˆ
2. âœ… å¹³è¡¡äº†æ¿€è¿›æ€§å’Œç¨³å®šæ€§
3. âœ… æœ€æœ‰å¯èƒ½è¾¾åˆ°ç›®æ ‡ï¼ˆAlphaç†µ0.3-0.5ï¼‰
4. âœ… é£é™©å¯æ§

**å®æ–½æ­¥éª¤**:

1. **å‡†å¤‡è®­ç»ƒè„šæœ¬**
   ```bash
   # ä¿®æ”¹train_v3_gat_moe.pyï¼Œæ·»åŠ æ¸©åº¦é€€ç«é€»è¾‘
   # æˆ–è€…åˆ›å»ºæ–°çš„è®­ç»ƒè„šæœ¬train_v3_deep_finetune.py
   ```

2. **å¯åŠ¨è®­ç»ƒ**
   ```bash
   python ablation_v3/train/train_v3_gat_moe.py \
       --exp-name deep_finetune_7000 \
       --episodes 7000 \
       --max-steps 500 \
       --resume ablation_v3/results/finetune_5000/checkpoints/model_final.pth
   ```

3. **ç›‘æ§æŒ‡æ ‡**
   - Alphaç†µï¼ˆç›®æ ‡: 0.3-0.5ï¼‰
   - å¹³å‡åˆ†æ•°ï¼ˆç›®æ ‡: 15-20+ï¼‰
   - æ–¹å·®ï¼ˆå¯èƒ½ç»§ç»­ä¸Šå‡ï¼Œä½†ä¸æ˜¯ä¸»è¦é—®é¢˜ï¼‰
   - è®­ç»ƒç¨³å®šæ€§ï¼ˆæ— NaN/Infï¼‰

4. **é¢„æœŸæ—¶é—´**
   - 2000 episodes Ã— ~5ç§’/episode = ~2.5å°æ—¶

---

## å®éªŒå¯¹æ¯”æ–¹æ¡ˆ

### ğŸ§ª A/Bæµ‹è¯•

å¦‚æœèµ„æºå……è¶³ï¼Œå¯ä»¥åŒæ—¶è¿è¡Œä¸¤ä¸ªæ–¹æ¡ˆè¿›è¡Œå¯¹æ¯”ï¼š

**å®éªŒA: ç»§ç»­æ¸©åº¦é€€ç«**
```bash
python ablation_v3/train/train_v3_gat_moe.py \
    --exp-name deep_finetune_7000_temp02 \
    --episodes 7000 \
    --sparsemax-temp-end 0.2
```

**å®éªŒB: æ¿€è¿›æ¸©åº¦é€€ç«**
```bash
python ablation_v3/train/train_v3_gat_moe.py \
    --exp-name aggressive_finetune_6000_temp01 \
    --episodes 6000 \
    --sparsemax-temp-end 0.1
```

**å¯¹æ¯”æŒ‡æ ‡**:
- Alphaç†µ
- å¹³å‡åˆ†æ•°
- æœ€é«˜åˆ†æ•°
- è®­ç»ƒç¨³å®šæ€§

---

## é•¿æœŸæ”¹è¿›æ–¹å‘

### 1. è‡ªé€‚åº”æ¸©åº¦é€€ç«

**æ€è·¯**: æ ¹æ®Alphaç†µè‡ªåŠ¨è°ƒæ•´æ¸©åº¦

```python
# å¦‚æœAlphaç†µä¸‹é™ç¼“æ…¢ï¼ŒåŠ å¿«é€€ç«
if alpha_entropy_change < threshold:
    temperature *= 0.9
```

### 2. ä¸“å®¶è´Ÿè½½å‡è¡¡ä¼˜åŒ–

**æ€è·¯**: ç¡®ä¿æ¯ä¸ªä¸“å®¶éƒ½è¢«å……åˆ†ä½¿ç”¨

```python
# å¢åŠ è´Ÿè½½å‡è¡¡ç³»æ•°
load_balance_coef = 0.02  # ä»0.01æé«˜åˆ°0.02
```

### 3. è¯¾ç¨‹å­¦ä¹ 

**æ€è·¯**: ä»ç®€å•åœºæ™¯åˆ°å¤æ‚åœºæ™¯é€æ­¥è®­ç»ƒ

```python
# å…ˆè®­ç»ƒç®€å•åœºæ™¯ï¼ˆçŸ­episodeï¼‰
# å†è®­ç»ƒå¤æ‚åœºæ™¯ï¼ˆé•¿episodeï¼‰
```

### 4. ä¸“å®¶å¯è§†åŒ–

**æ€è·¯**: å¯è§†åŒ–æ¯ä¸ªä¸“å®¶çš„æ¿€æ´»æ¨¡å¼

```python
# åˆ†æä¸åŒåœºæ™¯ä¸‹çš„Alphaåˆ†å¸ƒ
# ç¡®è®¤ä¸“å®¶æ˜¯å¦çœŸçš„åœ¨ä¸“ä¸šåŒ–
```

---

## æ€»ç»“

### å½“å‰çŠ¶æ€

âœ… **æˆåŠŸçš„æ–¹é¢**:
- åˆ†æ•°æŒç»­æå‡ï¼ˆ+43.9% vs Warmupï¼‰
- æœ€é«˜åˆ†çªç ´ï¼ˆ489ï¼‰
- ä¸“å®¶å¼€å§‹ä¸“ä¸šåŒ–ï¼ˆAlphaç†µ1.38 â†’ 0.69ï¼‰
- è®­ç»ƒç¨³å®š

âš ï¸  **éœ€è¦æ”¹è¿›çš„æ–¹é¢**:
- Alphaç†µåœæ»ï¼ˆ0.69ï¼Œç›®æ ‡0.3-0.5ï¼‰
- å¹³å‡åˆ†æ•°ä½äºé¢„æœŸï¼ˆ12.23ï¼Œç›®æ ‡15-20ï¼‰
- æ–¹å·®ä¸Šå‡ï¼ˆä½†å¯èƒ½ä¸æ˜¯åäº‹ï¼‰

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

ğŸš€ **å¼ºçƒˆæ¨è**: æ‰§è¡Œæ–¹æ¡ˆ1ï¼ˆç»§ç»­æ¸©åº¦é€€ç«ï¼‰

**é¢„æœŸæ•ˆæœ**:
- Alphaç†µ: 0.69 â†’ 0.3-0.5
- å¹³å‡åˆ†æ•°: 12.23 â†’ 15-20+
- ä¸“å®¶å®Œå…¨ä¸“ä¸šåŒ–

**é¢„è®¡æ—¶é—´**: ~2.5å°æ—¶

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2026-01-10 00:35  
**ä¸‹ä¸€æ­¥**: å‡†å¤‡Deep Fine-tuneè®­ç»ƒè„šæœ¬
